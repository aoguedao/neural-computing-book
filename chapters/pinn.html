
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Physics-Informed Neural Networks &#8212; Neural Computing</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/GMU_PLogo_4CP.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Neural Computing</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Neural Computing Book
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Computational Thinking
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="computational_thinking_part1.html">
   Introduction to Computational Thinking
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="computational_thinking_part2.html">
   Introduction to Computational Thinking - Part 2
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Regression
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="ml_regresssion.html">
   ML - Regression
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Classification
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="ml_classification.html">
   ML - Classification
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/aoguedao/neural-computing-book/main?urlpath=tree/chapters/pinn.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/aoguedao/neural-computing-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/aoguedao/neural-computing-book/issues/new?title=Issue%20on%20page%20%2Fchapters/pinn.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/chapters/pinn.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motivation">
   Motivation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pinns">
     PINNs
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup">
   Setup
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#implementation-deepxde">
   Implementation: DeepXDE
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-burguers-equation">
   Example: Burguers Equation
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Physics-Informed Neural Networks</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motivation">
   Motivation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pinns">
     PINNs
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup">
   Setup
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#implementation-deepxde">
   Implementation: DeepXDE
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-burguers-equation">
   Example: Burguers Equation
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="physics-informed-neural-networks">
<h1>Physics-Informed Neural Networks<a class="headerlink" href="#physics-informed-neural-networks" title="Permalink to this headline">#</a></h1>
<section id="motivation">
<h2>Motivation<a class="headerlink" href="#motivation" title="Permalink to this headline">#</a></h2>
<p>For years mathematicians and physicists are trying to model the world with differential equations. However, since the advent of techniques such as machine learning, neural networks and deep learning together with greater computing power, community has speculated that we could learn automatically (algorithms) anything with a enough amount of data. However, it seems this is not really true.</p>
<p>Philosophical Question: Could have a <em>machine</em> discovered Newton’s laws?</p>
<section id="pinns">
<h3>PINNs<a class="headerlink" href="#pinns" title="Permalink to this headline">#</a></h3>
<p>In 2019, Raissi, Perdikaris and Karniadakis introduced Physics-Informed Neural Networks (PINNs), neural networks that are trained to solve supervised learning tasks while respecting any given law of physics described by general nonlinear partial differential equations (<a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0021999118307125">source</a>). PINNs are nowadays used to solve PDEs, fractional equations, and integral-differential equations.</p>
<p><strong>Idea</strong></p>
<p>PINNs approximate PDE solutions by training a neural network to minimize a loss function, including:</p>
<ul class="simple">
<li><p>Initial and boundary conditions along the space-time domain’s boundary</p></li>
<li><p>PDE residual at selected points in the domain.</p></li>
</ul>
<p>If you want to do a simplified analogy, initial and boundary conditions points will be an usual training dataset, but also it is necessary to embed physical laws (PDE) into the neural network.</p>
</section>
</section>
<section id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">#</a></h2>
<p>PINNs can solve differential equations expressed, in the most general form, like:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\mathcal{F}(u(z); \lambda) &amp;= f(z) \quad z \text{ in } \Omega \\
\mathcal{B}(u(z)) &amp;= g(z) \quad z \text{ in } \partial \Omega
\end{align*}
\end{split}\]</div>
<p>defined on the domain <span class="math notranslate nohighlight">\(\Omega \subset \mathbb{R}^d\)</span> with the boundary <span class="math notranslate nohighlight">\(\partial \Omega\)</span>. Where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(z := (x_1, x_2, \ldots, t)^\top\)</span> indicated the space-time coordinate vector,</p></li>
<li><p><span class="math notranslate nohighlight">\(u\)</span> the unknown function,</p></li>
<li><p><span class="math notranslate nohighlight">\(\lambda\)</span> the parameters related to the physics,</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathcal{F}\)</span> the non-linear differential operator,</p></li>
<li><p><span class="math notranslate nohighlight">\(f\)</span> the function identifying the data of the problem,</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathcal{B}\)</span> the operator indicating arbitrary initial or boundary conditions, and</p></li>
<li><p><span class="math notranslate nohighlight">\(g\)</span> the boundary function.</p></li>
</ul>
<p>In the PINN methodology, <span class="math notranslate nohighlight">\(u(z)\)</span> is computationally predicted by a NN, parametrized by a set of parameters <span class="math notranslate nohighlight">\(\theta\)</span>, giving rise to an approximation
$<span class="math notranslate nohighlight">\(
\hat{u}_\theta(z) \approx u(z)
\)</span>$</p>
<p>The optimization problem we want to deal with it is</p>
<div class="math notranslate nohighlight">
\[
\min_\theta \; \omega_\mathcal{F} \mathcal{L}_\mathcal{F}(\theta) + \omega_\mathcal{B} \mathcal{L}_\mathcal{B}(\theta) + \omega_{\text{data}} \mathcal{L}_{\text{data}}(\theta)
\]</div>
<p>this is three weighted loss functions, each one depending on</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathcal{L}_\mathcal{F}\)</span>, differential equation,</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathcal{L}_\mathcal{B}\)</span>, boundary conditions, and</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathcal{L}_{\text{data}}\)</span>, (eventually) some known data.</p></li>
</ul>
<p><img alt="PINNs" src="images/info_pinn.png" /></p>
<p><a class="reference external" href="https://link.springer.com/article/10.1007/s10915-022-01939-z">Source</a></p>
</section>
<section id="implementation-deepxde">
<h2>Implementation: DeepXDE<a class="headerlink" href="#implementation-deepxde" title="Permalink to this headline">#</a></h2>
<p>DeepXDE is a library for scientific machine learning and physics-informed learning. It support several tensor libraries as backend (TensorFlow, PyTorch, JAX, among other).</p>
<p>One of its main features is that enables the user code to be compact, resembling closely the mathematical formulation. We don’t have to worry much about the technical aspect of the code, but rather about the mathematical model.</p>
<p><img alt="DeepXDE" src="images/pinn.webp" /></p>
<p><a class="reference external" href="https://deepxde.readthedocs.io/en/latest/">Source</a></p>
</section>
<section id="example-burguers-equation">
<h2>Example: Burguers Equation<a class="headerlink" href="#example-burguers-equation" title="Permalink to this headline">#</a></h2>
<p>We will solve a Burquers equation</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial u}{\partial t} + u\frac{\partial u}{\partial x} = \nu\frac{\partial^2u}{\partial x^2}, \qquad x \in [-1, 1], \quad t \in [0, 1]
\]</div>
<p>with the Dirichlet boundary conditions and initial conditions
$<span class="math notranslate nohighlight">\(
u(-1,t)=u(1,t)=0, \quad u(x,0) = - \sin(\pi x).
\)</span>$</p>
<p>Official documentation tutorial <a class="reference external" href="https://deepxde.readthedocs.io/en/latest/demos/pinn_forward/burgers.html">here</a>.</p>
<p><strong>Remarks:</strong></p>
<ul class="simple">
<li><p>If you are working on Google Colab you need to install <code class="docutils literal notranslate"><span class="pre">DeepXDE</span></code> and enable GPU.</p>
<ol class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">!pip</span> <span class="pre">install</span> <span class="pre">deepxde</span></code></p></li>
<li><p>Go to Menu <code class="docutils literal notranslate"><span class="pre">Menu</span> <span class="pre">&gt;</span> <span class="pre">Runtime</span> <span class="pre">&gt;</span> <span class="pre">Change</span> <span class="pre">Runtime</span></code> and change hardware accelaration to <strong>GPU</strong>.</p></li>
</ol>
</li>
<li><p>If you are working on your own machine, please follow the <a class="reference external" href="https://deepxde.readthedocs.io/en/latest/user/installation.html">install and setup documentation</a>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Uncomment and run the next line if you are working on Google Colab </span>
<span class="c1"># !pip install deepxde</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">deepxde</span> <span class="k">as</span> <span class="nn">dde</span>
<span class="kn">from</span> <span class="nn">deepxde.backend</span> <span class="kn">import</span> <span class="n">tf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using backend: tensorflow.compat.v1
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">deepxde</span> <span class="k">as</span> <span class="nn">dde</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">from</span> <span class="nn">deepxde.backend</span> <span class="kn">import</span> <span class="n">tf</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">mambaforge</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">nc</span><span class="o">-</span><span class="n">book</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.11</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">deepxde</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">17</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span> <span class="kn">from</span> <span class="nn">.__about__</span> <span class="kn">import</span> <span class="n">__version__</span>
<span class="g g-Whitespace">     </span><span class="mi">16</span> <span class="c1"># Should import backend before importing anything else</span>
<span class="ne">---&gt; </span><span class="mi">17</span> <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">backend</span>
<span class="g g-Whitespace">     </span><span class="mi">19</span> <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">callbacks</span>
<span class="g g-Whitespace">     </span><span class="mi">20</span> <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">data</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">mambaforge</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">nc</span><span class="o">-</span><span class="n">book</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.11</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">deepxde</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">100</span>
<span class="g g-Whitespace">     </span><span class="mi">96</span>     <span class="n">set_default_backend</span><span class="p">(</span><span class="s2">&quot;tensorflow.compat.v1&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">97</span>     <span class="k">return</span> <span class="s2">&quot;tensorflow.compat.v1&quot;</span>
<span class="ne">--&gt; </span><span class="mi">100</span> <span class="n">load_backend</span><span class="p">(</span><span class="n">get_preferred_backend</span><span class="p">())</span>
<span class="g g-Whitespace">    </span><span class="mi">103</span> <span class="k">def</span> <span class="nf">is_enabled</span><span class="p">(</span><span class="n">api</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">104</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Return true if the api is enabled by the current backend.</span>
<span class="g g-Whitespace">    </span><span class="mi">105</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">106</span><span class="sd">     Args:</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">110</span><span class="sd">         bool: ``True`` if the API is enabled by the current backend.</span>
<span class="g g-Whitespace">    </span><span class="mi">111</span><span class="sd">     &quot;&quot;&quot;</span>

<span class="nn">File ~/mambaforge/envs/nc-book/lib/python3.11/site-packages/deepxde/backend/__init__.py:36,</span> in <span class="ni">load_backend</span><span class="nt">(mod_name)</span>
<span class="g g-Whitespace">     </span><span class="mi">33</span>     <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Unsupported backend: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">mod_name</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">35</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Using backend: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">mod_name</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">36</span> <span class="n">mod</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="s2">&quot;.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">mod_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">),</span> <span class="vm">__name__</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">37</span> <span class="n">thismod</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span>
<span class="g g-Whitespace">     </span><span class="mi">38</span> <span class="c1"># log backend name</span>

<span class="nn">File ~/mambaforge/envs/nc-book/lib/python3.11/importlib/__init__.py:126,</span> in <span class="ni">import_module</span><span class="nt">(name, package)</span>
<span class="g g-Whitespace">    </span><span class="mi">124</span>             <span class="k">break</span>
<span class="g g-Whitespace">    </span><span class="mi">125</span>         <span class="n">level</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="ne">--&gt; </span><span class="mi">126</span> <span class="k">return</span> <span class="n">_bootstrap</span><span class="o">.</span><span class="n">_gcd_import</span><span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="n">level</span><span class="p">:],</span> <span class="n">package</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">mambaforge</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">nc</span><span class="o">-</span><span class="n">book</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.11</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">deepxde</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">tensorflow_compat_v1</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">5</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">os</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;TF_FORCE_GPU_ALLOW_GROWTH&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;true&quot;</span>
<span class="ne">----&gt; </span><span class="mi">5</span> <span class="kn">from</span> <span class="nn">.tensor</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># pylint: disable=redefined-builtin</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">mambaforge</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">nc</span><span class="o">-</span><span class="n">book</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.11</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">deepxde</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">tensorflow_compat_v1</span><span class="o">/</span><span class="n">tensor</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">4</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;tensorflow.compat.v1 backend implementation&quot;&quot;&quot;</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">from</span> <span class="nn">packaging.version</span> <span class="kn">import</span> <span class="n">Version</span>
<span class="ne">----&gt; </span><span class="mi">4</span> <span class="kn">import</span> <span class="nn">tensorflow.compat.v1</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="k">if</span> <span class="n">Version</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">Version</span><span class="p">(</span><span class="s2">&quot;2.7.0&quot;</span><span class="p">):</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span>     <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;DeepXDE requires TensorFlow&gt;=2.7.0.&quot;</span><span class="p">)</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;tensorflow&#39;
</pre></div>
</div>
</div>
</div>
<p>First of all, we need to define the domain when we will work on</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">geom</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">Interval</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">timedomain</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">TimeDomain</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">)</span>
<span class="n">geomtime</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">GeometryXTime</span><span class="p">(</span><span class="n">geom</span><span class="p">,</span> <span class="n">timedomain</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The PDE residual is</p>
<div class="math notranslate nohighlight">
\[
\mathcal{L}_{\mathcal{F}}(\theta) =
\frac{\partial \hat{u}_\theta}{\partial t} + \hat{u}_\theta\frac{\partial \hat{u}_\theta}{\partial x} - \nu\frac{\partial^2 \hat{u}_\theta}{\partial x^2}
\]</div>
<p>Then we express the PDE residual in a function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pde</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">dy_x</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">dy_t</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">dy_xx</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">hessian</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dy_t</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="n">dy_x</span> <span class="o">-</span> <span class="mf">0.01</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">dy_xx</span>
</pre></div>
</div>
</div>
</div>
<p>The first argument to <code class="docutils literal notranslate"><span class="pre">pde</span></code> is 2-dimensional vector where the first component(<code class="docutils literal notranslate"><span class="pre">x[:,0]</span></code>) is :math:<code class="docutils literal notranslate"><span class="pre">x</span></code>-coordinate and the second componenet (<code class="docutils literal notranslate"><span class="pre">x[:,1]</span></code>) is the :math:<code class="docutils literal notranslate"><span class="pre">t</span></code>-coordinate. The second argument is the network output, i.e., the solution :math:<code class="docutils literal notranslate"><span class="pre">u(x,t)</span></code>, but here we use <code class="docutils literal notranslate"><span class="pre">y</span></code> as the name of the variable.</p>
<p>Now, let’s continue with initial and boundary conditions</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bc</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">icbc</span><span class="o">.</span><span class="n">DirichletBC</span><span class="p">(</span>
    <span class="n">geomtime</span><span class="p">,</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span>
    <span class="n">on_boundary</span><span class="p">:</span> <span class="n">on_boundary</span>
<span class="p">)</span>
<span class="n">ic</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">icbc</span><span class="o">.</span><span class="n">IC</span><span class="p">(</span>
    <span class="n">geomtime</span><span class="p">,</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]),</span>
    <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span>
    <span class="n">on_initial</span><span class="p">:</span> <span class="n">on_initial</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, we can define our PDE in a <code class="docutils literal notranslate"><span class="pre">TimePDE</span></code> object</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">TimePDE</span><span class="p">(</span>
    <span class="n">geomtime</span><span class="p">,</span>
    <span class="n">pde</span><span class="p">,</span>
    <span class="p">[</span><span class="n">bc</span><span class="p">,</span> <span class="n">ic</span><span class="p">],</span>
    <span class="n">num_domain</span><span class="o">=</span><span class="mi">2540</span><span class="p">,</span>
    <span class="n">num_boundary</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
    <span class="n">num_initial</span><span class="o">=</span><span class="mi">160</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/aoguedao/mambaforge/envs/pinn/lib/python3.9/site-packages/skopt/sampler/sobol.py:246: UserWarning: The balance properties of Sobol&#39; points require n to be a power of 2. 0 points have been previously generated, then: n=0+2542=2542. 
  warnings.warn(&quot;The balance properties of Sobol&#39; points require &quot;
/home/aoguedao/mambaforge/envs/pinn/lib/python3.9/site-packages/skopt/sampler/sobol.py:246: UserWarning: The balance properties of Sobol&#39; points require n to be a power of 2. 0 points have been previously generated, then: n=0+82=82. 
  warnings.warn(&quot;The balance properties of Sobol&#39; points require &quot;
/home/aoguedao/mambaforge/envs/pinn/lib/python3.9/site-packages/skopt/sampler/sobol.py:246: UserWarning: The balance properties of Sobol&#39; points require n to be a power of 2. 0 points have been previously generated, then: n=0+162=162. 
  warnings.warn(&quot;The balance properties of Sobol&#39; points require &quot;
</pre></div>
</div>
</div>
</div>
<p>Where</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">num_domain</span></code> is the number of training residual points sampled inside the domain,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_boundary</span></code> is the number of training points sampled on the boundary, and</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_initial</span></code> is the number of residual points for the initial conditions.</p></li>
</ul>
<p>Just at this point we can we choose the network. Here, we use a fully connected neural network of depth 4 (i.e., 3 hidden layers) and width 20, hyperbolic tangent as activation function and a standar way to initialize the NN called <em>Glorot normal</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">net</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">FNN</span><span class="p">([</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;tanh&quot;</span><span class="p">,</span> <span class="s2">&quot;Glorot normal&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Notice it has two neurons in the input layer, corresponding to time and 1-Dimensional space. However the output layer is just one neuron since <span class="math notranslate nohighlight">\(u(t,x) \in \mathbb{R}\)</span>.</p>
<p>Now we need to create an object with our PDE and NN. Also it is necessary to indicate the optimizer we will use.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">dde</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">net</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;adam&quot;</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/aoguedao/mambaforge/envs/pinn/lib/python3.9/site-packages/deepxde/nn/tensorflow_compat_v1/fnn.py:103: UserWarning: `tf.layers.dense` is deprecated and will be removed in a future version. Please use `tf.keras.layers.Dense` instead.
  return tf.layers.dense(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Compiling model...
Building feed-forward neural network...
&#39;build&#39; took 0.043998 s
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-10-12 11:43:25.601584: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;compile&#39; took 0.297932 s
</pre></div>
</div>
</div>
</div>
<p>We then train the model for 15000 iterations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">losshistory</span><span class="p">,</span> <span class="n">train_state</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">iterations</span><span class="o">=</span><span class="mi">15000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initializing variables...
Training model...

Step      Train loss                        Test loss                         Test metric
0         [2.30e-01, 2.71e-01, 9.09e-01]    [2.30e-01, 2.71e-01, 9.09e-01]    []  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-10-12 11:43:25.890971: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:354] MLIR V1 optimization pass is not enabled
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1000      [4.44e-02, 3.73e-03, 6.66e-02]    [4.44e-02, 3.73e-03, 6.66e-02]    []  
2000      [3.68e-02, 1.08e-03, 5.02e-02]    [3.68e-02, 1.08e-03, 5.02e-02]    []  
3000      [2.75e-02, 3.96e-04, 3.88e-02]    [2.75e-02, 3.96e-04, 3.88e-02]    []  
4000      [1.78e-02, 3.89e-04, 2.52e-02]    [1.78e-02, 3.89e-04, 2.52e-02]    []  
5000      [1.06e-02, 1.31e-04, 1.40e-02]    [1.06e-02, 1.31e-04, 1.40e-02]    []  
6000      [8.31e-03, 7.71e-05, 9.83e-03]    [8.31e-03, 7.71e-05, 9.83e-03]    []  
7000      [7.01e-03, 5.07e-05, 6.62e-03]    [7.01e-03, 5.07e-05, 6.62e-03]    []  
8000      [5.56e-03, 3.19e-05, 4.45e-03]    [5.56e-03, 3.19e-05, 4.45e-03]    []  
9000      [4.29e-03, 2.89e-05, 3.76e-03]    [4.29e-03, 2.89e-05, 3.76e-03]    []  
10000     [3.61e-03, 2.29e-05, 3.23e-03]    [3.61e-03, 2.29e-05, 3.23e-03]    []  
11000     [2.91e-03, 1.82e-05, 2.52e-03]    [2.91e-03, 1.82e-05, 2.52e-03]    []  
12000     [1.84e-03, 1.52e-05, 1.49e-03]    [1.84e-03, 1.52e-05, 1.49e-03]    []  
13000     [1.51e-03, 1.50e-05, 1.21e-03]    [1.51e-03, 1.50e-05, 1.21e-03]    []  
14000     [1.33e-03, 1.31e-05, 1.06e-03]    [1.33e-03, 1.31e-05, 1.06e-03]    []  
15000     [1.23e-03, 1.08e-05, 9.74e-04]    [1.23e-03, 1.08e-05, 9.74e-04]    []  

Best model at step 15000:
  train loss: 2.22e-03
  test loss: 2.22e-03
  test metric: []

&#39;train&#39; took 56.506519 s
</pre></div>
</div>
</div>
</div>
<p>After we train the network using Adam, we continue to train the network using L-BFGS to achieve a smaller loss:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;L-BFGS-B&quot;</span><span class="p">)</span>
<span class="n">losshistory</span><span class="p">,</span> <span class="n">train_state</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Compiling model...
&#39;compile&#39; took 0.144206 s

Training model...

Step      Train loss                        Test loss                         Test metric
15000     [1.23e-03, 1.08e-05, 9.74e-04]    [1.23e-03, 1.08e-05, 9.74e-04]    []  
16000     [3.42e-04, 1.71e-06, 1.75e-04]                                          
17000     [1.35e-04, 1.56e-06, 5.74e-05]                                          
18000     [7.67e-05, 4.28e-07, 1.97e-05]                                          
19000     [4.58e-05, 3.63e-07, 7.05e-06]                                          
20000     [2.60e-05, 1.73e-07, 3.14e-06]                                          
21000     [1.49e-05, 1.01e-07, 1.56e-06]                                          
22000     [8.42e-06, 7.99e-08, 1.14e-06]                                          
INFO:tensorflow:Optimization terminated with:
  Message: CONVERGENCE: REL_REDUCTION_OF_F_&lt;=_FACTR*EPSMCH
  Objective function value: 0.000009
  Number of iterations: 6699
  Number of functions evaluations: 7242
22242     [8.01e-06, 6.20e-08, 8.80e-07]    [8.01e-06, 6.20e-08, 8.80e-07]    []  

Best model at step 22242:
  train loss: 8.95e-06
  test loss: 8.95e-06
  test metric: []

&#39;train&#39; took 37.846161 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dde</span><span class="o">.</span><span class="n">saveplot</span><span class="p">(</span><span class="n">losshistory</span><span class="p">,</span> <span class="n">train_state</span><span class="p">,</span> <span class="n">issave</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">isplot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/pinn_34_0.png" src="../_images/pinn_34_0.png" />
<img alt="../_images/pinn_34_1.png" src="../_images/pinn_34_1.png" />
</div>
</div>
<p>Let’s compare the predicted solution with the real solution</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="n">burguers_filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">()</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;data&quot;</span> <span class="o">/</span> <span class="s2">&quot;Burgers.npz&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">burguers_filepath</span><span class="p">)</span>
<span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">exact</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;usol&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">tt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">xx</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">tt</span><span class="p">)))</span><span class="o">.</span><span class="n">T</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="n">exact</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[:,</span> <span class="kc">None</span><span class="p">]</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">operator</span><span class="o">=</span><span class="n">pde</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean residual:&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">f</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;L2 relative error:&quot;</span><span class="p">,</span> <span class="n">dde</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">l2_relative_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean residual: 0.008336143
L2 relative error: 0.05253457073427108
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Alonso Ogueda & Padhu Seshaiyer<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>